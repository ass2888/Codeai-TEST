<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no" />
<link rel="manifest" href="/manifest.json" />
<title>Codeai</title>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Archives:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css"> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
</head>
<body>
  <div id="update-banner" style="
    display: none; 
    position: fixed; 
    top: 0; 
    left: 0; 
    width: 100%; 
    background-color: #f7b731; 
    color: #111; 
    padding: 10px; 
    text-align: center; 
    z-index: 10000; 
    font-size: 14px;
">
There is a new update available!
    <button id="reload-app-btn" style="
        background-color: #111; 
        color: #fff; 
        border: none; 
        padding: 5px 10px; 
        margin-right: 10px;
        cursor: pointer;
        border-radius: 4px;
        margin-left: 10px;
    ">Update</button>
</div>

<button id="menuBtn" class="menu-btn" aria-label="menu"><span>☰</span></button>

<button id="codeToggleBtn" class="code-toggle-btn" title="Show Code"></button>
  <div id="welcomeScreen">
    <div class="welcome-logo">
          <img src="assets/logo.png" alt="Codeai Logo">
      </div>
      
      <div class="welcome-sub">What can I help you with?</div>
  </div>
  <div class="topbar">
    <div id="topLogo" class="logo-container">
        <span class="logo-symbol">&lt;</span>
        <span class="logo-text-part">Codeai</span>
    </div>
  </div>
  <div id="menuPanel">
    <button id="newChatBtn">New chat +</button>
    <h3 style="margin:10px 0 5px 0; color:var(--text-color); opacity:0.6; font-size:12px; text-transform:uppercase">Conversations</h3>
    <div id="convList"></div>
    <button id="openSettings">Settings</button>
<div id="appVersion" style="margin-top:10px; font-size:11px; color:var(--text-color); opacity:0.4; text-align:center; font-family:monospace;">
    v0.0.0
</div>
  </div>

  <div class="root">
    <div id="messages" class="messages" aria-live="polite"></div>
    <div id="suggestionBar" class="suggestions-wrapper">
        </div>

    <div class="input-bar">
      <div class="input-wrapper">
         <textarea id="input" class="input" placeholder="Type a message..." rows="1"></textarea>
        <button id="sendBtn" class="send-btn" title="Send">
    <svg viewBox="0 0 24 24" width="28" height="28" stroke="currentColor" stroke-width="3" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="18 15 12 9 6 15"></polyline>
    </svg>
</button>
      </div>
    </div>
  </div>
  <div id="codezone" class="codezone" aria-hidden="true">
    <input type="file" id="importFileInput" style="display: none;" accept=".html,.js,.css,.txt,.json">

    <div class="code-header-wrapper">
        <div class="code-toolbar">
            <div style="font-weight:bold; font-size:16px;">Project Code</div>
            
            <div class="toolbar-group">
              <button class="tool-btn" id="btnRunAll" title="Run All Files">
              <span style="font-size:14px; margin-top:-2px">▶</span>
              <span style="font-size:9px; font-weight:900">ALL</span>
              </button>
              <button class="tool-btn" id="btnEdit" title="Edit Mode (E)">E</button>
                <button class="tool-btn" id="btnImport" title="Import (M)">M</button>
                <button class="tool-btn" id="btnExport" title="Export (X)">X</button>
                <button class="tool-btn" id="btnCopy" title="Copy (C)">C</button>
                
                <button id="closeCodeBtn" class="settings-btn" style="font-size:13px; width:auto; padding:6px 12px; margin-left:5px;">Back</button>
            </div>
        </div>

        <div class="tabs-bar" id="tabsContainer">
            <button id="addTabBtn" class="tab-add-btn">+</button>
        </div>
    </div>
    
<div class="editor-container">
    <div id="lineNumbers" class="line-numbers">1</div>
    
    <div class="code-wrapper">
        <pre class="code-highlight-layer" aria-hidden="true"><code id="highlighting-content" class="language-javascript"></code></pre>
        
        <textarea id="codeArea" class="codearea" spellcheck="false" wrap="off"></textarea>
    </div>
</div>
    
 

    <button id="runFab" class="run-fab" title="Run Code">
      <div class="play-icon"></div>
    </button>
</div>


<div id="previewOverlay" class="fullscreen-overlay">
  <div id="gamePreview">
    <div id="gameLoading">Starting game...</div>
  <img id="gameFrame" />
</div>
    <div class="preview-header">
      <div style="display:flex; align-items:center;">
          <span style="margin-right:15px; font-weight:bold;">Live Preview</span>
          <button id="btnToggleOutput">Output</button>
      </div>
      <button id="closePreviewMain" class="settings-btn" style="background:#ddd; color:#000; font-size:14px;width:auto;padding:6px 15px;">Close</button>
    </div>
       
        <div id="consoleOutputView" class="console-view"></div>
    
    <iframe id="previewFrame" style="flex:1; border:none; width: 100%; display: block;"></iframe>

    <canvas id="gameCanvas" style="display:none; margin: auto; max-width: 100%; max-height: 100%; image-rendering: pixelated; box-shadow: 0 0 20px black;"></canvas>
</div>


    <canvas id="gameCanvas" style="display:none; flex:1; background-color: black; image-rendering: pixelated; width: 100%; height: 100%;"></canvas>
</div>



<div id="settingsPage" class="settings-page" aria-hidden="true">
    <h2 style="margin-bottom:30px; margin-top:40px">Settings</h2>
    
    <div style="position:relative;">
        <button id="themeBtn" class="setting-row-btn">
            Theme <span id="themeValue" class="setting-value">Dark</span>
        </button>
        <div id="themePopover" class="popover-options">
            <div class="option-item" onclick="setTheme('dark')">Dark</div>
            <div class="option-item" onclick="setTheme('light')">Light</div>
        </div>
    </div>

    <div style="position:relative;">
        <button id="langBtn" class="setting-row-btn">
            Language <span id="langValue" class="setting-value">English</span>
        </button>
        <div id="langPopover" class="popover-options">
            <div class="option-item" onclick="setLanguage('en')">English</div>
            <div class="option-item" onclick="setLanguage('ar')">العربية</div>
        </div>
    </div>

    <div style="margin-top:auto; display:flex; justify-content:center; margin-bottom: 20px;">
      <button id="closeSettings" style="padding:14px 40px; border-radius:30px; background:transparent; border:1px solid var(--border-color); color:var(--text-color); cursor:pointer">Close</button>
    </div>
  </div>
  <div id="tabModal" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-title">Edit Tab</div>
        <input type="text" id="tabNameInput" class="modal-input" placeholder="File name...">
        <div class="modal-actions">
            <button id="modalSaveBtn" class="btn-save">Save</button>
            <button id="modalDeleteBtn" class="btn-delete">Delete File</button>
            <button id="modalCancelBtn" class="settings-btn" style="background:transparent; border:none;">Cancel</button>
        </div>
        
    </div>
</div>
<div id="deleteConfirmModal" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-title" id="delModalTitle">Confirm Deletion</div>
        
        <div style="font-size:14px; opacity:0.8; margin-bottom:10px; line-height:1.5" id="delModalMsg">
            Are you sure you want to delete this file?
        </div>
        
        <div class="modal-actions">
            <button id="realDeleteBtn" class="btn-delete">Delete</button>
            <button id="cancelDeleteConfirmBtn" class="settings-btn" style="background:transparent; border:none;">Cancel</button>
        </div>
    </div>
</div>
<div id="convOptionsModal" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-title">Conversation Options</div>
        <input type="text" id="convRenameInput" class="modal-input" placeholder="Conversation Title...">
        <div class="modal-actions">
            <button id="btnSaveConvName" class="btn-save">Save Rename</button>
            <button id="btnDeleteConv" class="btn-delete">Delete Conversation</button>
            <button id="btnCloseConvModal" class="settings-btn" style="background:transparent; border:none;">Cancel</button>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.12.0/brython.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.12.0/brython_stdlib.min.js"></script>

<script>
    window.onload = function() {
        // تشغيل أولي لتهيئة المكتبة
        brython();
    };
</script>


 <script src="app.js"></script> 
</body>
</html>