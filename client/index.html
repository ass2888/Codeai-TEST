<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,user-scalable=no" />
<link rel="manifest" href="/manifest.json" />
<title>Codeai</title>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Archives:wght@400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css"> 
<link rel="icon" type="image/png" href="/icons/icon-192x192.png">
<link rel="apple-touch-icon" href="/icons/icon-192x192.png">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
</head>
<body>
<!-- شاشة التحميل بالفيديو -->
<div id="splashScreen">

    <div id="splashVideoContainer">
    <video id="splashVideo" autoplay muted playsinline disablePictureInPicture controlslist="nodownload nofullscreen noremoteplayback">
            <source src="assets/splash-dark.mp4" type="video/mp4">
            <!-- إذا فشل الفيديو، نعرض الصورة -->
            <img src="icons/icon-512x512.png" alt="CodeAI Logo" style="display:none;">
        </video>
    </div>


    <div id="splashLogo" class="splash-logo" style="display: none;">
        <img src="icons/icon-512x512.png" alt="CodeAI Logo">
    </div>
    
    <!-- نص النسخة (مخفى في البداية) -->
<div class="splash-version" id="splashVersion" style="opacity: 0;">
        الإصدار v1.277.1
    </div>
</div>
</div>
  <div id="update-banner" style="
    display: none; 
    position: fixed; 
    top: 0; 
    left: 0; 
    width: 100%; 
    background-color: #f7b731; 
    color: #111; 
    padding: 10px; 
    text-align: center; 
    z-index: 10000; 
    font-size: 14px;
">
There is a new update available!
    <button id="reload-app-btn" style="
        background-color: #111; 
        color: #fff; 
        border: none; 
        padding: 5px 10px; 
        margin-right: 10px;
        cursor: pointer;
        border-radius: 4px;
        margin-left: 10px;
    ">Update</button>
</div>

<button id="menuBtn" class="menu-btn" aria-label="menu"><span>☰</span></button>

<button id="codeToggleBtn" class="code-toggle-btn" title="Show Code"></button>
  <div id="welcomeScreen">
    <div class="welcome-logo">
          <img src="assets/logo-dark.png" alt="Codeai Logo">
      </div>
      
      <div class="welcome-sub">
      <span data-i18n="What">What can I help you with?</span>
        </div>
  </div>
 <!-- أضف هذا في body بعد splash screen وقبل أي عناصر أخرى -->
<button id="modelSelectorBtn" class="model-selector-btn">
    <span class="model-name">Gemini 3 Flash</span>
    <span class="model-arrow">▼</span>
</button>

<div id="modelDropdown" class="model-dropdown">
    <div class="model-dropdown-header">
        <h2>Choose AI</h2>
        <button class="model-close-btn">×</button>
    </div>
    <div class="model-list">
      <div class="model-item selected" data-model="auto">
  <div class="model-item-header">
                    <div class="model-info">
                    <h3>Auto</h3>
                    <p>Recommended</p>
                </div>
            <div class="model-status">Current</div>
  </div>
</div>
      <div class="model-item" data-model="codeai-code-r">
  <div class="model-item-header">
                    <div class="model-info">
                    <h3>Codeai code-R 1.0</h3>
                    <p>Super Powerful, a program from 3 models</p>
                </div>

  </div>
</div>
        <div class="model-item" data-model="gemini-3-flash">
            <div class="model-item-header">

                <div class="model-info">
                    <h3>Gemini 3 Flash</h3>
                    <p>Fast & efficient for everyday tasks</p>
                </div>
            </div>

        </div>
        
<div class="model-item" data-model="gemini-2.5-pro">
    <div class="model-item-header">

        <div class="model-info">
            <h3>Gemini 2.5 Pro</h3>
            <p>Advanced with 1M token context</p>
        </div>
    </div>
</div>

<div class="model-item" data-model="gemini-2.5 flash">
    <div class="model-item-header">

        <div class="model-info">
            <h3>Gemini 2.5 flash</h3>
            <p>Fast and efficient</p>
        </div>
    </div>
</div>

<div class="model-item" data-model="gpt-oss-120b">
    <div class="model-item-header">
        <div class="model-info">
            <h3>GPT-OSS 120B</h3>
            <p>An advanced model engineered for deep, complex reasoning.</p>
        </div>
    </div>
</div>

<div class="model-item" data-model="gpt-oss">
    <div class="model-item-header">
        <div class="model-info">
            <h3>GPT-OSS 20B</h3>
            <p>A lightweight and smart model, ideal for general chat and quick text tasks.</p>
        </div>
    </div>
</div>

<div class="model-item" data-model="chimera-r1">
    <div class="model-item-header">
        <div class="model-info">
            <h3>DeepSeek (Chimera R1T2)</h3>
            <p>Reasoning (DeepSeek Distill)</p>
        </div>
    </div>
</div>

            <!--<div class="model-item" data-model="deepseek-coder">
    <div class="model-item-header">

        <div class="model-info">
            <h3>DeepSeek Coder</h3>
            <p>Specialized for programming</p>
        </div>
    </div>
</div>
<div class="model-item" data-model="deepseek-chat">
    <div class="model-item-header">
        <div class="model-info">
            <h3>DeepSeek Chat</h3>
            <p>General purpose chat assistant</p>
        </div>
    </div>
</div>-->
<div class="model-item" data-model="qwen-coder">
    <div class="model-item-header">
        <div class="model-info">
            <h3>Qwen 3 Coder 480B</h3>
            <p>Specialized for coding</p>
        </div>
    </div>
</div>

<div class="model-item" data-model="trinity-large">
    <div class="model-item-header">
        <div class="model-info">
            <h3>Trinity Large 400B</h3>
            <p>Advanced reasoning</p>
        </div>
    </div>
</div>

<div class="model-item" data-model="llama-3.3-70b">
    <div class="model-item-header">
        <div class="model-info">
            <h3>LLaMA 3.3 70B</h3>
            <p>High-performance model for complex reasoning and scale.</p>
        </div>
    </div>
</div>

<div class="model-item" data-model="llama-3.1-instant">
    <div class="model-item-header">
        <div class="model-info">
            <h3>LLaMA 3.1 8B Instant</h3>
            <p>Ultra-fast, lightweight model for real-time tasks.</p>
        </div>
    </div>
</div>

<div class="model-item" data-model="groq-compound">
    <div class="model-item-header">
        <div class="model-info">
            <h3>Groq Compound</h3>
            <p>Optimized system for extreme speed and smooth performance.</p>
        </div>
    </div>
</div>

<div class="model-item" data-model="hermes-3">
    <div class="model-item-header">
        <div class="model-info">
            <h3>Hermes 3 405B</h3>
            <p>The largest open-weights model, providing superior instruction following and inference.</p>
        </div>
    </div>
</div>

<div class="model-item" data-model="solar-pro">
    <div class="model-item-header">
        <div class="model-info">
            <h3>Solar Pro 3</h3>
            <p>Strong instruction-following model with good reasoning and long-context understanding.</p>
        </div>
    </div>
</div>

<!-- <div class="model-item" data-model="kimi-k2">
    <div class="model-item-header">

        <div class="model-info">
            <h3>Kimi k2</h3>
            <p>kimi</p>
        </div>
    </div>
</div> -->




    </div>
</div>
  <div class="topbar">
    <div id="topLogo" class="logo-container">
        <span class="logo-symbol">&lt;</span>
        <span class="logo-text-part">Codeai</span>
    </div>
  </div>
  <div id="menuPanel">
    <button id="newChatBtn">New chat +</button>
    <h3 style="margin:10px 0 5px 0; color:var(--text-color); opacity:0.6; font-size:12px; text-transform:uppercase">Conversations</h3>
    <div id="convList"></div>
    <button id="openSettings">
        <span data-i18n="settings">Settings</span>
    </button>
<div id="appVersion" style="margin-top:10px; font-size:11px; color:var(--text-color); opacity:0.4; text-align:center; font-family:monospace;">
    v0.0.0
</div>
  </div>

  <div class="root">
    <div id="messages" class="messages" aria-live="polite"></div>
    <div id="suggestionBar" class="suggestions-wrapper">
        </div>

    <div class="input-bar">
      <div class="input-wrapper">

    <div id="inputAttachments" class="input-attachments-area" style="display:none;"></div>

         <textarea id="input" class="input" placeholder="Type a message..." rows="1"></textarea>
        <button id="sendBtn" class="send-btn" title="Send">
    <svg viewBox="0 0 24 24" width="28" height="28" stroke="currentColor" stroke-width="4" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <polyline points="18 15 12 9 6 15"></polyline>
    </svg>
</button>
      </div>
    </div>
  </div>
  <div id="codezone" class="codezone" aria-hidden="true">
    <input type="file" id="importFileInput" style="display: none;" accept=".html,.js,.css,.txt,.json">

    <div class="code-header-wrapper">
        <div class="code-toolbar">
            <div style="font-weight:bold; font-size:16px;">
              <span data-i18n="Project">Project Code</span>
              </div>
            
            <div class="toolbar-group">
              <button class="tool-btn" id="btnUndo" title="Undo" data-i18n-title="undo">U</button>
        <button class="tool-btn" id="btnRedo" title="Redo" data-i18n-title="redo">R</button>
              <button class="tool-btn" id="btnEdit" title="Edit Mode (E)">E</button>
                <button class="tool-btn" id="btnImport" title="Import (M)">M</button>
                <button class="tool-btn" id="btnExport" title="Export (X)">X</button>
                <button class="tool-btn" id="btnCopy" title="Copy (C)">C</button>
                
                <button id="closeCodeBtn" class="settings-btn" style="font-size:13px; width:auto; padding:6px 12px; margin-left:5px;">Back</button>
            </div>
        </div>

        <div class="tabs-bar" id="tabsContainer">
            <button id="addTabBtn" class="tab-add-btn">+</button>
        </div>
    </div>
    
<div class="editor-container">
    <div id="lineNumbers" class="line-numbers">1</div>
    
    <div class="code-wrapper">
        <pre class="code-highlight-layer" aria-hidden="true"><code id="highlighting-content" class="language-javascript"></code></pre>
        
        <textarea id="codeArea" class="codearea" spellcheck="false" wrap="off"></textarea>
    </div>
</div>
    
 

<div class="run-sticky-container">
    
    <button id="runFab" class="run-fab" title="Run Code">
      <div class="play-icon"></div>
    </button>

    <div class="run-options-sidebar">
        <button id="btnRunOptions" class="dots-btn">...</button>
    </div>

</div>




</div>


<div id="previewOverlay" class="fullscreen-overlay">
  <div id="gamePreview">
    <div id="previewErrorBanner" class="preview-error-banner" style="display: none;">
        <span>⚠️ حدث خطأ أثناء التشغيل (انقر للتفاصيل)</span>
    </div>

  <img id="gameFrame" />
</div>
    <div class="preview-header">
      <div style="display:flex; align-items:center;">
          <span style="margin-right:15px; font-weight:bold;">Live Preview</span>
          <button id="btnToggleOutput">Output</button>
      </div>
      <button id="closePreviewMain" class="settings-btn" style="background:#ddd; color:#000; font-size:14px;width:auto;padding:6px 15px;">Close</button>
    </div>
       
        <div id="consoleOutputView" class="console-view"></div>
    
    <iframe id="previewFrame" style="flex:1; border:none; width: 100%; display: block;"></iframe>

    <canvas id="gameCanvas" style="display:none; margin: auto; max-width: 100%; max-height: 100%; image-rendering: pixelated; box-shadow: 0 0 20px black;"></canvas>
</div>


    <canvas id="gameCanvas" style="display:none; flex:1; background-color: black; image-rendering: pixelated; width: 100%; height: 100%;"></canvas>
</div>



<div id="settingsPage" class="settings-page" aria-hidden="true">
    <h2 style="margin-bottom:30px; margin-top:40px">Settings</h2>
    
    <div style="position:relative;">
        <button id="themeBtn" class="setting-row-btn">
                      <span data-i18n="theme">Theme</span>
             <span id="themeValue" class="setting-value">DT</span>
        </button>
        <div id="themePopover" class="popover-options">
            <div class="option-item" onclick="setTheme('dark')">
                                    <span data-i18n="darktheme">Dark</span>
              </div>
            <div class="option-item" onclick="setTheme('light')">
                                    <span data-i18n="lighttheme">Light</span>
              </div>
        </div>
    </div>

    <div style="position:relative;">
        <button id="langBtn" class="setting-row-btn">
            <span data-i18n="Language">Language</span>
             <span id="langValue" class="setting-value">English</span>
        </button>
        <div id="langPopover" class="popover-options">
            <div class="option-item" onclick="setLanguage('en')">English</div>
            <div class="option-item" onclick="setLanguage('ar')">العربية</div>
        </div>
    </div>
    <div style="position:relative;">
        <button id="styleBtn" class="setting-row-btn">
            <span data-i18n="convStyle">Conversation Style</span> 
            <span id="styleValue" class="setting-value">
              <span data-i18n="Detailed1">Detailed</span> 
              </span>
        </button>
        <div id="stylePopover" class="popover-options">
            <div class="option-item" onclick="setConvStyle('Detailed')">                          <span data-i18n="Detailed">Detailed (Developers)</span> </div>
            <div class="option-item" onclick="setConvStyle('Simple')">
                          <span data-i18n="Simple">Simple (Non-tech)</span> 
              </div>
        </div>
    </div>

    <div style="position:relative;">
        <button id="prefLangBtn" class="setting-row-btn">
            <span data-i18n="prefLang">Preferred Language</span> 
            <span id="prefLangValue" class="setting-value">HTML</span>
        </button>
        <div id="prefLangPopover" class="popover-options">
            <div class="option-item" onclick="setPrefLang('HTML')">HTML/JS</div>
            <div class="option-item" onclick="setPrefLang('Python')">Python</div>
            <div class="option-item" onclick="setPrefLang('PHP')">PHP</div>
            <div class="option-item" onclick="setPrefLang('Java')">Java</div>
            <div class="option-item" onclick="setPrefLang('C++')">C++</div>
        </div>
    </div>
    <div style="position:relative;">
    <button id="fontSizeBtn" class="setting-row-btn">
        <span data-i18n="fontSize">Font Size</span> 
        <span id="fontSizeValue" class="setting-value">
            <span data-i18n="medium">Medium</span>
        </span>
    </button>
    <div id="fontSizePopover" class="popover-options">
        <div class="option-item" onclick="setFontSize('small')">
            <span data-i18n="small">Small</span>
        </div>
        <div class="option-item" onclick="setFontSize('medium')">
            <span data-i18n="medium">Medium</span>
        </div>
        <div class="option-item" onclick="setFontSize('large')">
            <span data-i18n="large">Large</span>
        </div>
        <div class="option-item" onclick="setFontSize('xlarge')">
            <span data-i18n="xlarge">Extra Large</span>
        </div>
    </div>
</div>

    <div style="margin-top:auto; display:flex; justify-content:center; margin-bottom: 20px;">
      <button id="closeSettings" style="padding:14px 40px; border-radius:30px; background:transparent; border:1px solid var(--border-color); color:var(--text-color); cursor:pointer">Close</button>
    </div>
  </div>
  <div id="tabModal" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-title">Edit Tab</div>
        <input type="text" id="tabNameInput" class="modal-input" placeholder="File name...">
        <div class="modal-actions">
            <button id="modalSaveBtn" class="btn-save">Save</button>
            <button id="modalDeleteBtn" class="btn-delete">Delete File</button>
            <button id="modalCancelBtn" class="settings-btn" style="background:transparent; border:none;">Cancel</button>
        </div>
        
    </div>
</div>
<div id="deleteConfirmModal" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-title" id="delModalTitle">Confirm Deletion</div>
        
        <div style="font-size:14px; opacity:0.8; margin-bottom:10px; line-height:1.5" id="delModalMsg">
            Are you sure you want to delete this file?
        </div>
        
        <div class="modal-actions">
            <button id="realDeleteBtn" class="btn-delete">Delete</button>
            <button id="cancelDeleteConfirmBtn" class="settings-btn" style="background:transparent; border:none;">Cancel</button>
        </div>
    </div>
</div>
<div id="convOptionsModal" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-title">Conversation Options</div>
        <input type="text" id="convRenameInput" class="modal-input" placeholder="Conversation Title...">
        <div class="modal-actions">
            <button id="btnSaveConvName" class="btn-save">Save Rename</button>
            <button id="btnDeleteConv" class="btn-delete">Delete Conversation</button>
            <button id="btnCloseConvModal" class="btn-cancel">Cancel</button>
        </div>
    </div>
</div>


<div id="runSettingsModal" class="modal-overlay">
    <div class="modal-box">
        <div class="modal-title" data-i18n="runButtonSettings">Run button</div>
        <div class="setting-row">
            <span data-i18n="defaultRunMode">Default Run Mode</span>
            <div class="sliding-toggle-container">
                <div id="toggleHighlight" class="toggle-highlight"></div>
                <div class="toggle-option active" onclick="setRunMode('all')" data-i18n="runAll">All</div>
                <div class="toggle-option" onclick="setRunMode('single')" data-i18n="runSingle">Single</div>
            </div>
        </div>
        <div class="modal-actions">
            <button id="btnRunShortcut" class="btn-save" style="width:100%"></button>
            <button onclick="closeAnimatedModal('runSettingsModal')" class="settings-btn" style="background:transparent; border:none;">Cancel</button>
        </div>
    </div>
</div>



<script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.12.0/brython.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/brython/3.12.0/brython_stdlib.min.js"></script>

<script>
    window.onload = function() {
        // تشغيل أولي لتهيئة المكتبة
        brython();
    };
</script>


 <script src="app.js"></script> 
</body>
</html>